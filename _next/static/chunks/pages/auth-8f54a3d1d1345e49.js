(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[634],{5764:(e,r,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth",function(){return i(6601)}])},6601:(e,r,i)=>{"use strict";i.r(r),i.d(r,{default:()=>p});var t=i(7876),a=i(4232),d=i(7660),n=i(2727),l=i(2009),s=i(8534);function o(){let[e,r]=(0,a.useState)(null),[i,o]=(0,a.useState)(""),[p,c]=(0,a.useState)(""),[x,u]=(0,a.useState)("");a.useEffect(()=>{let e=(0,s.hg)(n.j2,r);return()=>e()},[]);let g=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),f=e=>e.length>=6,h=async()=>{if(u(""),!g(i))return void u("正しいメールアドレスを入力してください。");if(!f(p))return void u("パスワードは6文字以上で入力してください。");try{let e=await (0,s.x9)(n.j2,i,p);r(e.user)}catch(r){if(r&&"object"==typeof r&&"code"in r)if("auth/user-not-found"===r.code)u("ユーザーが見つかりません。新規登録してください。");else if("auth/wrong-password"===r.code)u("パスワードが間違っています。");else{var e;u("ログインエラー: "+(null!=(e=r.message)?e:""))}else u("ログインエラー: 不明なエラー")}},b=async()=>{if(u(""),!g(i))return void u("正しいメールアドレスを入力してください。");if(!f(p))return void u("パスワードは6文字以上で入力してください。");try{let e=(await (0,s.eJ)(n.j2,i,p)).user,t=(0,l.aU)();await (0,l.BN)((0,l.H9)(t,"users",e.uid),{email:e.email,role:"user"}),r(e)}catch(r){if(r&&"object"==typeof r&&"code"in r)if("auth/email-already-in-use"===r.code)u("このメールアドレスは既に登録されています。ログインしてください。");else{var e;u("登録エラー: "+(null!=(e=r.message)?e:""))}else u("登録エラー: 不明なエラー")}},w=(0,d.h)(e);if(e){var m;return(0,t.jsxs)("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",padding:"16px",display:"flex",alignItems:"center",width:"100%",minWidth:"420px",gap:"16px",whiteSpace:"nowrap",overflow:"auto"},children:[(0,t.jsx)("span",{style:{padding:"8px 16px",background:"#fff",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"200px",display:"inline-block"},title:null!=(m=e.email)?m:"",children:e.email}),(0,t.jsx)("button",{onClick:()=>(0,s.CI)(n.j2),style:{border:"1px solid #ccc",borderRadius:"4px",padding:"8px 16px",background:"#fff",cursor:"pointer",whiteSpace:"nowrap"},children:"ログアウト"}),"admin"===w&&(0,t.jsx)("div",{style:{marginLeft:"16px",whiteSpace:"nowrap"},children:(0,t.jsx)("p",{style:{margin:0},children:"管理者専用"})})]})}return(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",minHeight:"100px"},children:[(0,t.jsxs)("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",padding:"16px",display:"flex",flexDirection:"column",alignItems:"flex-end",width:"260px"},children:[(0,t.jsx)("input",{type:"email",placeholder:"メールアドレス",value:i,onChange:e=>o(e.target.value),style:{border:"1px solid #ccc",borderRadius:"4px",padding:"8px 16px",marginBottom:"8px",background:"rgba(255,255,255,0.7)",width:"100%",boxSizing:"border-box"}}),(0,t.jsx)("input",{type:"password",placeholder:"パスワード",value:p,onChange:e=>c(e.target.value),style:{border:"1px solid #ccc",borderRadius:"4px",padding:"8px 16px",marginBottom:"8px",background:"rgba(255,255,255,0.7)",width:"100%",boxSizing:"border-box"}}),(0,t.jsx)("button",{type:"button",style:{border:"1px solid #ccc",borderRadius:"4px",padding:"8px 16px",background:"#fff",flex:1,marginRight:"8px"},onClick:h,children:"ログイン"}),(0,t.jsx)("button",{style:{border:"1px solid #ccc",borderRadius:"4px",padding:"8px 16px",background:"#fff",cursor:"pointer",flex:1},onClick:b,children:"新規登録"})]}),x&&(0,t.jsx)("div",{style:{color:"red",marginTop:"8px",fontSize:"0.9em",width:"100%"},children:x})]})}function p(){return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-900",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gray-900 dark:text-white",children:"認証ページ"}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8 w-full max-w-md",children:(0,t.jsx)(o,{})})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[636,593,792],()=>r(5764)),_N_E=e.O()}]);