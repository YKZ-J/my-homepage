(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[634],{5764:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth",function(){return r(6601)}])},6601:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var l=r(7876),n=r(4232),a=r(7660),s=r(2727),i=r(2009),o=r(8534);function c(){var e;let[t,r]=(0,n.useState)(null),[c,d]=(0,n.useState)(""),[u,m]=(0,n.useState)(""),[f,b]=(0,n.useState)("");n.useEffect(()=>{let e=(0,o.hg)(s.j2,r);return()=>e()},[]);let h=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),x=e=>e.length>=6,g=async()=>{if(b(""),!h(c))return void b("正しいメールアドレスを入力してください。");if(!x(u))return void b("パスワードは6文字以上で入力してください。");try{let e=await (0,o.x9)(s.j2,c,u);r(e.user)}catch(t){if(t&&"object"==typeof t&&"code"in t)if("auth/user-not-found"===t.code)b("ユーザーが見つかりません。新規登録してください。");else if("auth/wrong-password"===t.code)b("パスワードが間違っています。");else{var e;b("ログインエラー: "+(null!=(e=t.message)?e:""))}else b("ログインエラー: 不明なエラー")}},p=async()=>{if(b(""),!h(c))return void b("正しいメールアドレスを入力してください。");if(!x(u))return void b("パスワードは6文字以上で入力してください。");try{let e=(await (0,o.eJ)(s.j2,c,u)).user,t=(0,i.aU)();await (0,i.BN)((0,i.H9)(t,"users",e.uid),{email:e.email,role:"user"}),r(e)}catch(t){if(t&&"object"==typeof t&&"code"in t)if("auth/email-already-in-use"===t.code)b("このメールアドレスは既に登録されています。ログインしてください。");else{var e;b("登録エラー: "+(null!=(e=t.message)?e:""))}else b("登録エラー: 不明なエラー")}},y=(0,a.h)(t);return(0,l.jsx)("div",{className:"w-full flex flex-col items-center gap-6",children:t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"truncate w-full text-center",style:{padding:"0.75rem 1rem",background:"#fff",borderRadius:"0.5rem",color:"var(--foreground)",fontWeight:500,fontSize:"1rem",display:"block",marginBottom:"1rem"},title:null!=(e=t.email)?e:"",children:t.email}),(0,l.jsx)("button",{onClick:()=>(0,o.CI)(s.j2),className:"button button-blue w-full",style:{minWidth:"100px"},children:"ログアウト"}),"admin"===y&&(0,l.jsx)("div",{style:{marginTop:"1rem",color:"#992222",fontWeight:600},children:"admin"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("input",{type:"email",placeholder:"メールアドレス",value:c,onChange:e=>d(e.target.value),className:"w-full mb-2",style:{border:"1px solid #ccc",borderRadius:"0.5rem",padding:"0.75rem 1rem",background:"rgba(255,255,255,0.7)",fontSize:"1rem",color:"var(--foreground)",boxSizing:"border-box"}}),(0,l.jsx)("input",{type:"password",placeholder:"パスワード",value:u,onChange:e=>m(e.target.value),className:"w-full mb-2",style:{border:"1px solid #ccc",borderRadius:"0.5rem",padding:"0.75rem 1rem",background:"rgba(255,255,255,0.7)",fontSize:"1rem",color:"var(--foreground)",boxSizing:"border-box"}}),(0,l.jsxs)("div",{className:"flex w-full gap-2",children:[(0,l.jsx)("button",{type:"button",className:"button button-blue w-1/2",onClick:g,style:{minWidth:0},children:"log in"}),(0,l.jsx)("button",{type:"button",className:"button button-blue w-1/2",onClick:p,style:{minWidth:0},children:"sign up"})]}),f&&(0,l.jsx)("div",{style:{color:"#d32f2f",marginTop:"8px",fontSize:"0.95em",width:"100%",textAlign:"center"},children:f})]})})}function d(){return(0,l.jsx)("main",{className:"min-h-screen flex items-center justify-center",children:(0,l.jsxs)("div",{className:"container flex flex-col items-center justify-center rounded-3xl shadow-2xl p-8 gap-6 border border-blue-100 dark:border-gray-700 backdrop-blur",style:{width:"80vw",maxWidth:480,background:"var(--card-bg)"},children:[(0,l.jsx)("h1",{className:"text-3xl font-extrabold mb-6 text-center tracking-tight",style:{color:"var(--primary)"},children:"Authentication"}),(0,l.jsx)("div",{className:"w-full flex flex-col items-center",children:(0,l.jsx)(c,{})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(5764)),_N_E=e.O()}]);